<%= render 'navbars/back_navbar' %>
<div class="container inbox">
  <div id="filter-bar">
    <%= image_tag 'filter-icon.png' %>
  </div>
  <style>
    .hidden {
      display: none;
    }
  </style>
  <div class="hidden inbox-filter-menu" >
    <ul class="nav nav-tabs" role="tab-list">
      <li role="presentation" class="active" ><a id="tab" href="#document" data-toggle="tab" class="active" role="tab" aria-controls="document">Document Type</a></li>
      <li role="presentation"><a href="#property" id="tab" aria-controls="property" data-toggle="tab" role="tab"> Property</a></li>
    </ul>
    <div style="width: 100%" >
      <div role="tab-panel" id="document" class="tab-pane show fade in active">
        <form action="/messages" method="get">
          <div class="filter-category">
            <label for="doc_type">Invoice</label>
            <div class="round">
              <input name="doc_type" value="invoice" type="checkbox" id="checkbox1" <%= 'checked' if params[:doc_type]&.include?('invoice') %> />
              <label for="checkbox1"></label>
            </div>
          </div>
          <div class="filter-category">
            <label for="doc_type">Contract</label>
            <div class="round">
              <input name="doc_type" value="contract" type="checkbox" id="checkbox2" <%= 'checked' if params[:doc_type]&.include?('contract') %> />
              <label for="checkbox2"></label>
            </div>
          </div>
          <div class="filter-category">
            <label for="doc_type">Other</label>
            <div class="round">
              <input name="doc_type" value="other" type="checkbox" id="checkbox3" <%= 'checked' if params[:doc_type]&.include?('other') %> />
              <label for="checkbox3"></label>
            </div>
          </div>
        </div>
        <div role="tab-panel" class="tab-pane fade in" id="property">
          <% @listings.each do |listing| %>
            <div class="filter-category">
              <label for="listing_id"><%= listing.display_name %></label>
              <div class="round">
                <input name="listing_id[]" value="<%= listing.id %>" type="checkbox" id="<%= listing.id %>" <%= 'checked' if params[:listing_id]&.include?(listing.id.to_s) %> />
                <label for="<%= listing.id %>"></label>
              </div>
            </div>
          <% end %>
        </div>
        <input type="submit" value="OK" class="inbox-btn-yellow" />
    </div>

  </div>

  <% @messages.each do |message| %>
    <%= link_to message_path(message), "data-type" => message.doc_type  do %>
      <div class="inbox-card">
        <div style="display: flex; align-items: center;">
          <%= cl_image_tag message.listing.photos.first.content, class: 'inbox-avatar' %>
        </div>
        <div class="message-body">
          <div class="message-filters">
            <span class="property-filter"><i class="fa fa-times-circle" aria-hidden="true"></i> <%= message.listing.name.first(15) %></span>
            <span class="doc-filter"><i class="fa fa-times-circle" aria-hidden="true"></i> <%= message.doc_type %></span>
          </div>
          <div class="inbox-message">
            <h4><strong><%= message.title.first(40) %></strong></h4>
            <p><%= message.content.first(30) %>...</p>
          </div>
        </div>

        <div class="attachment-image">
          <% if message.attachment == 'invoice' || 'contract' && message.doc_type != 'other' %>
          <%= image_tag 'attachment_light_000000.png', class: 'attch' %>
          <% else %>
            <%= "" %>
          <% end %>
        </div>
      </div>
    <% end %>
  <% end %>
</div>
<%= render 'shared/footer' %>

